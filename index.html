<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen Data Hexacomm (Paper, Materi, Anggota, Alumni)</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Styles dari kode yang Anda berikan */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            max-width: 1400px;
        }

        /* --- Gaya Navigasi --- */
        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background-color: #F0E68C; /* Khaki (Kuning Muda) */
            border-radius: 0.5rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: background-color 0.3s, box-shadow 0.3s;
            margin-left: -1rem;
            margin-right: -1rem;
            width: calc(100% + 2rem);
        }

        .nav-item-inactive:hover {
            background-color: #FFEB3B;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .nav-text {
            font-weight: bold;
            color: #4B5563;
            font-size: 1rem;
            margin-left: 0.75rem;
        }

        .nav-item-inactive:hover .nav-text {
            color: #2C3E50;
        }

        .nav-item-active {
            background-color: #FFD700;
            color: white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            font-weight: bold;
        }

        .nav-item-active .nav-text {
            font-weight: bold;
            color: white;
        }
        .nav-item-active i {
            color: white; 
        }
        .nav-item-inactive i {
            color: #D6A238;
            transition: color 0.3s;
        }
        .nav-item-inactive:hover i {
            color: #B8860B;
        }

        /* Additional styling */
        #mainNav {
            margin-top: 20px;
        }
        
        /* --- Gaya Aplikasi --- */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        #visual-side {
            background: linear-gradient(135deg, #fffcf5, #ffffff);
            color: #4b5563;
        }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .animate-spin-fast { animation: spin 0.5s linear infinite; }
        .sortable-header { transition: background-color 0.2s ease-in-out; }
        .sort-icon-wrapper i { transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out; }
        .main-page-header {
            @apply bg-white p-5 rounded-xl shadow-lg border-l-8 border-yellow-500 mb-4;
        }
        .view-background-texture {
            background-color: #fefefe;
            background-image: repeating-linear-gradient(
                45deg, 
                #fcfcfc, 
                #fcfcfc 15px, 
                #f9f9f9 15px, 
                #f9f9f9 30px
            );
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.03);
        }
        #loginSection {
            min-height: 100vh;
            padding: 0; 
        }
        #loginSection > div {
             margin-top: 2rem;
             margin-bottom: 2rem;
        }
        
        /* Gaya untuk Modal (Edit) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
        }

        .modal-content {
            background-color: #fff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
            width: 95%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        /* Gaya untuk badge CV */
        .cv-link-cell {
            @apply flex items-center justify-center space-x-1;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }
        .cv-link-cell a {
            @apply p-1.5 rounded-full text-base; 
            transition: background-color 0.2s;
        }
        .cv-link-cell .cv-available {
            @apply bg-green-100 text-green-700 hover:bg-green-200;
        }
        .cv-link-cell .cv-missing {
             @apply text-gray-400;
        }

        /* BARU: Gaya untuk kontak yang lebih rapi di tabel */
        .contact-entry {
            @apply flex items-center space-x-1 text-xs px-2 py-1 bg-blue-50 text-blue-800 rounded-lg;
            margin-bottom: 2px;
        }
        .contact-entry a {
             color: inherit;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- BAGIAN 1: LOGIN SECTION -->
    <div id="loginSection" class="flex-grow flex items-center justify-center">
        <div class="w-full max-w-sm md:max-w-4xl lg:max-w-5xl flex rounded-2xl shadow-2xl overflow-hidden mx-4">
            
            <!-- Left Side: Visual/Logo -->
            <div id="visual-side" class="hidden md:block md:w-1/2 p-12 relative flex flex-col justify-center items-center">
                <div class="text-center">
                    <img id="loginLogo" 
                        class="max-w-[150px] h-auto mx-auto mb-4 p-3 rounded-xl shadow-lg object-contain border border-yellow-100" 
                        src="" 
                        alt="Logo Hexacomm.png"
                        onerror="this.onerror=null; this.src='https://placehold.co/150x150/fde047/78350f?text=Hexa';">

                    <h2 class="text-3xl font-extrabold mb-2 text-yellow-700">Paper Riset Hexacomm</h2>
                    <p class="mt-4 leading-relaxed text-gray-600">
                        Website pemantau paper kalian.
                    </p>
                    <div class="mt-8">
                        <span class="text-sm font-semibold border-b-2 border-yellow-700 text-yellow-800">#HexaRnd</span>
                    </div>
                </div>
            </div>

            <!-- Right Side: Login Form -->
            <div class="w-full md:w-1/2 bg-white p-8 md:p-10 lg:p-12">
                <div class="text-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-800">Masukkan ID Anda</h1>
                    <p class="text-gray-500 text-sm mt-2">Belum ada? tanya RnD</p>
                </div>

                <form id="loginForm" class="space-y-6">
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="username">Username</label>
                        <input type="text" id="username" placeholder="Masukkan username" required
                            class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="password">Password</label>
                        <input type="password" id="password" placeholder="Masukkan password" required
                            class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
                    </div>
                    
                    <button type="submit" 
                        class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 rounded-lg transition duration-300 shadow-lg disabled:opacity-50">
                        Masuk
                    </button>
                </form>
                <p id="loginError" class="text-red-500 text-center mt-6 text-sm hidden"></p>
            </div>
        </div>
    </div>

    <!-- BAGIAN 2: APLIKASI UTAMA (Diperbarui dengan Sidebar) -->
    <div id="appSection" class="hidden flex-grow flex p-4 md:p-8">
        <div class="container mx-auto flex flex-col lg:flex-row space-y-6 lg:space-y-0 lg:space-x-8">
            
            <!-- HEADER APLIKASI UTAMA (Pindah ke sini) -->
            <div class="absolute top-4 right-4 z-10">
                <button id="logoutButton" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg text-sm font-semibold transition shadow flex items-center justify-center space-x-1">
                    <i data-lucide="log-out" class="w-4 h-4"></i>
                    <span>Logout</span>
                </button>
            </div>

            <!-- SIDEBAR NAVIGASI -->
            <aside class="w-full lg:w-64 bg-white p-6 rounded-xl shadow-lg flex-shrink-0">
                <div class="flex flex-col mb-8 border-b pb-4">
                    <div class="flex items-center text-xl font-bold text-gray-800 mb-4">
                        <img id="headerLogo" 
                            class="w-8 h-8 mr-2 object-contain rounded-md" 
                            src="" 
                            alt="Logo"
                            onerror="this.onerror=null; this.src='https://placehold.co/32x32/fde047/78350f?text=H';">
                        <span class="text-yellow-600">Hexa RnD</span>
                    </div>
                </div>

                <nav id="mainNav" class="space-y-2">
                    <!-- Menu Existing -->
                    <div id="nav-paper" class="nav-item nav-item-active" data-view="paper">
                        <i data-lucide="file-text" class="w-5 h-5 mr-3"></i>
                        <span class="nav-text">Manajemen Paper</span>
                    </div>
                    <div id="nav-materi" class="nav-item nav-item-inactive" data-view="materi">
                        <i data-lucide="folder-tree" class="w-5 h-5 mr-3"></i>
                        <span class="nav-text">Manajemen Materi</span>
                    </div>
                    <!-- Menu BARU: Anggota -->
                    <div id="nav-anggota" class="nav-item nav-item-inactive" data-view="anggota">
                        <i data-lucide="users" class="w-5 h-5 mr-3"></i>
                        <span class="nav-text">Data Anggota</span>
                    </div>
                    <!-- Menu BARU: Alumni -->
                    <div id="nav-alumni" class="nav-item nav-item-inactive" data-view="alumni">
                        <i data-lucide="graduation-cap" class="w-5 h-5 mr-3"></i>
                        <span class="nav-text">Data Alumni</span>
                    </div>
                </nav>
            </aside>
            
            <!-- KONTEN UTAMA -->
            <main id="mainContent" class="flex-grow w-full">
                
                <!-- VIEW 1: MANAJEMEN PAPER (EXISTING) -->
                <div id="paperView" class="view-content hidden space-y-4">
                    <div class="main-page-header">
                        <h1 class="text-3xl font-bold text-gray-800 flex items-center p-0">
                            <i data-lucide="file-text" class="w-8 h-8 mr-3 text-yellow-600"></i>
                            Manajemen Paper
                        </h1>
                        <p class="text-sm text-gray-500 mt-1 pl-11">Kelola, tambah, dan pantau status paper riset.</p>
                    </div>

                    <div class="view-background-texture space-y-8 p-6">
                    
                        <!-- Form Tambah Paper -->
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-xl border-t-4 border-yellow-500">
                            <h2 class="text-2xl font-semibold text-yellow-700 mb-4 flex items-center space-x-2">
                                <i data-lucide="book-plus" class="w-6 h-6"></i>
                                <span>Tambah Paper Baru</span>
                            </h2>
                            <form id="paperForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <input type="text" id="title" placeholder="Judul Paper (Wajib)" required
                                    class="col-span-1 md:col-span-2 p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                                <input type="text" id="authors" placeholder="Nama Penulis (Pisahkan dengan koma)"
                                    class="p-3 border border-gray-300 rounded-lg">
                                <select id="status" required
                                    class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                                    <option value="" disabled selected>Pilih Status</option>
                                    <option value="Draft">Draft</option>
                                    <option value="Submitted">Submitted</option>
                                    <option value="Under Review">Under Review</option>
                                    <option value="Accepted">Accepted</option>
                                    <option value="Rejected">Rejected</option>
                                </select>
                                <input type="text" id="category" placeholder="Kategori (Jurnal/Konferensi/Lainnya)"
                                    class="p-3 border border-gray-300 rounded-lg">
                                <input type="date" id="deadline" placeholder="Deadline"
                                    class="p-3 border border-gray-300 rounded-lg">
                                <input type="url" id="reference_link" placeholder="Link Referensi (URL)"
                                    class="p-3 border border-gray-300 rounded-lg">
                                <input type="url" id="overleaf_link" placeholder="Link Overleaf (URL)"
                                    class="p-3 border border-gray-300 rounded-lg">
                                <input type="url" id="ppt_link" placeholder="Link PPT/Slide (URL)"
                                    class="p-3 border border-gray-300 rounded-lg">
                                
                                <button type="submit" id="submitPaperButton"
                                    class="col-span-1 md:col-span-3 bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300 shadow-xl shadow-yellow-400/50 hover:shadow-2xl hover:shadow-yellow-500/70 disabled:opacity-50 flex items-center justify-center space-x-2">
                                </button>
                                <p id="formPaperMessage" class="col-span-3 text-sm text-center hidden"></p>
                            </form>
                        </div>

                        <!-- Bagian Pencarian dan Daftar Paper -->
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-xl">
                            <h2 class="text-2xl font-semibold text-yellow-700 mb-4 flex items-center space-x-2">
                                <i data-lucide="list-checks" class="w-6 h-6"></i>
                                <span>Daftar Paper</span>
                            </h2>
                            
                            <!-- Input Pencarian -->
                            <input type="text" id="searchPaper" placeholder="Cari berdasarkan Judul atau Penulis..."
                                class="w-full p-3 mb-6 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">

                            <!-- Tabel Paper -->
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th onclick="handleHeaderSortClick('title', 'paper')" data-sort-key="title" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">
                                                <div class="flex items-center space-x-1"><span>Judul</span> <span class="sort-icon-wrapper paper" data-col="title"></span></div>
                                            </th>
                                            <th onclick="handleHeaderSortClick('authors', 'paper')" data-sort-key="authors" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">
                                                <div class="flex items-center space-x-1"><span>Penulis</span> <span class="sort-icon-wrapper paper" data-col="authors"></span></div>
                                            </th>
                                            <th onclick="handleHeaderSortClick('status', 'paper')" data-sort-key="status" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">
                                                <div class="flex items-center space-x-1"><span>Status</span> <span class="sort-icon-wrapper paper" data-col="status"></span></div>
                                            </th>
                                            <th onclick="handleHeaderSortClick('category', 'paper')" data-sort-key="category" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell cursor-pointer hover:bg-gray-100 sortable-header">
                                                <div class="flex items-center space-x-1"><span>Kategori</span> <span class="sort-icon-wrapper paper" data-col="category"></span></div>
                                            </th>
                                            <th onclick="handleHeaderSortClick('deadline', 'paper')" data-sort-key="deadline" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell cursor-pointer hover:bg-gray-100 sortable-header">
                                                <div class="flex items-center space-x-1"><span>Deadline</span> <span class="sort-icon-wrapper paper" data-col="deadline"></span></div>
                                            </th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="papersList" class="bg-white divide-y divide-gray-200">
                                        <!-- Data paper akan dimasukkan di sini oleh JavaScript -->
                                    </tbody>
                                </table>
                                <p id="noPaperDataMessage" class="hidden p-4 text-center text-gray-500 mt-4">Tidak ada paper yang ditemukan.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW 2: MANAJEMEN MATERI (EXISTING) -->
                <div id="materiView" class="view-content hidden space-y-4">
                    <div class="main-page-header">
                        <h1 class="text-3xl font-bold text-gray-800 flex items-center p-0">
                            <i data-lucide="folder-tree" class="w-8 h-8 mr-3 text-yellow-600"></i>
                            Manajemen Materi
                        </h1>
                        <p class="text-sm text-gray-500 mt-1 pl-11">Arsip dan kelola materi presentasi atau *sharing knowledge*.</p>
                    </div>

                    <div class="view-background-texture space-y-8 p-6">
                        
                        <!-- Form Tambah Materi -->
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-xl border-t-4 border-yellow-500">
                            <h2 class="text-2xl font-semibold text-yellow-700 mb-4 flex items-center space-x-2">
                                <i data-lucide="folder-plus" class="w-6 h-6"></i>
                                <span>Tambah Materi Baru</span>
                            </h2>
                            <form id="materiForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <select id="divisi" required
                                    class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                                    <option value="" disabled selected>Pilih Divisi (Wajib)</option>
                                    <option value="5G">5G</option>
                                    <option value="IoT">IoT</option>
                                    <option value="Umum">Umum</option>
                                </select>
                                <input type="text" id="judul_materi" placeholder="Judul Materi (Wajib)" required
                                    class="col-span-1 md:col-span-2 p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                                <input type="text" id="pembuat" placeholder="Nama Pembuat"
                                    class="p-3 border border-gray-300 rounded-lg">
                                <input type="date" id="tanggal_jadi" placeholder="Tanggal Jadi"
                                    class="p-3 border border-gray-300 rounded-lg">
                                <input type="url" id="link_materi" placeholder="Link Materi (URL Wajib)" required
                                    class="p-3 border border-gray-300 rounded-lg">
                                <!-- INPUT BARU UNTUK LINK PPT -->
                                <input type="url" id="ppt_link_materi" placeholder="Link PPT/Slide (Opsional)"
                                    class="p-3 border border-gray-300 rounded-lg">
                                
                                <button type="submit" id="submitMateriButton"
                                    class="col-span-1 md:col-span-3 bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300 shadow-xl shadow-yellow-400/50 hover:shadow-2xl hover:shadow-yellow-500/70 disabled:opacity-50 flex items-center justify-center space-x-2">
                                </button>
                                <p id="formMateriMessage" class="col-span-3 text-sm text-center hidden"></p>
                            </form>
                        </div>

                        <!-- Bagian Pencarian dan Daftar Materi -->
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-xl">
                            <h2 class="text-2xl font-semibold text-yellow-700 mb-4 flex items-center space-x-2">
                                <i data-lucide="list" class="w-6 h-6"></i>
                                <span>Daftar Materi</span>
                            </h2>
                               <!-- Input Pencarian Materi -->
                            <input type="text" id="searchMateri" placeholder="Cari berdasarkan Judul atau Pembuat..."
                                class="w-full p-3 mb-6 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">

                            <!-- Tabel Materi -->
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th onclick="handleHeaderSortClick('judul_materi', 'materi')" data-sort-key="judul_materi" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">
                                                <div class="flex items-center space-x-1"><span>Judul Materi</span> <span class="sort-icon-wrapper materi" data-col="judul_materi"></span></div>
                                            </th>
                                            <th onclick="handleHeaderSortClick('divisi', 'materi')" data-sort-key="divisi" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">
                                                <div class="flex items-center space-x-1"><span>Divisi</span> <span class="sort-icon-wrapper materi" data-col="divisi"></span></div>
                                            </th>
                                            <th onclick="handleHeaderSortClick('pembuat', 'materi')" data-sort-key="pembuat" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell cursor-pointer hover:bg-gray-100 sortable-header">
                                                <div class="flex items-center space-x-1"><span>Pembuat</span> <span class="sort-icon-wrapper materi" data-col="pembuat"></span></div>
                                            </th>
                                            <th onclick="handleHeaderSortClick('tanggal_jadi', 'materi')" data-sort-key="tanggal_jadi" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell cursor-pointer hover:bg-gray-100 sortable-header">
                                                <div class="flex items-center space-x-1"><span>Tgl Jadi</span> <span class="sort-icon-wrapper materi" data-col="tanggal_jadi"></span></div>
                                            </th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="materiList" class="bg-white divide-y divide-gray-200">
                                        <!-- Data materi akan dimasukkan di sini oleh JavaScript -->
                                    </tbody>
                                </table>
                                <p id="noMateriDataMessage" class="hidden p-4 text-center text-gray-500 mt-4">Tidak ada materi yang ditemukan.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW 3: MANAJEMEN ANGGOTA (BARU) -->
                <div id="anggotaView" class="view-content hidden space-y-4">
                    <div class="main-page-header">
                        <h1 class="text-3xl font-bold text-gray-800 flex items-center p-0">
                            <i data-lucide="users" class="w-8 h-8 mr-3 text-yellow-600"></i>
                            Data Anggota Hexacomm
                        </h1>
                        <p class="text-sm text-gray-500 mt-1 pl-11">Kelola data anggota aktif saat ini.</p>
                    </div>

                    <div class="view-background-texture space-y-8 p-6">
                        
                        <!-- Form Tambah Anggota -->
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-xl border-t-4 border-yellow-500">
                            <h2 class="text-2xl font-semibold text-yellow-700 mb-4 flex items-center space-x-2">
                                <i data-lucide="user-plus" class="w-6 h-6"></i>
                                <span>Tambah Anggota Baru</span>
                            </h2>
                            <form id="anggotaForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <input type="text" id="anggota_nama" placeholder="Nama Lengkap (Wajib)" required class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                                <input type="text" id="anggota_batch" placeholder="Batch (Ex: B1)" class="p-3 border border-gray-300 rounded-lg">
                                <input type="number" id="anggota_angkatan" placeholder="Angkatan (Ex: 2021)" min="2010" max="2100" class="p-3 border border-gray-300 rounded-lg">
                                
                                <!-- Jabatan -->
                                <select id="anggota_jabatan" required class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                                    <option value="" disabled selected>Pilih Jabatan (Wajib)</option>
                                </select>

                                <!-- Divisi -->
                                <select id="anggota_divisi" required class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                                    <option value="" disabled selected>Pilih Divisi (Wajib)</option>
                                </select>
                                
                                <input type="email" id="anggota_email" placeholder="Email (Wajib)" required class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                                <input type="tel" id="anggota_no_handphone" placeholder="No. Handphone" class="p-3 border border-gray-300 rounded-lg">
                                <input type="date" id="anggota_tanggal_lahir" placeholder="Tanggal Lahir" class="p-3 border border-gray-300 rounded-lg">
                                <input type="text" id="anggota_organisasi_lain" placeholder="Organisasi Lain" class="p-3 border border-gray-300 rounded-lg">
                                <input type="url" id="anggota_link_cv" placeholder="Link CV/Portofolio (URL)" class="col-span-1 md:col-span-2 p-3 border border-gray-300 rounded-lg">

                                <button type="submit" id="submitAnggotaButton"
                                    class="col-span-1 md:col-span-3 bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300 shadow-xl shadow-yellow-400/50 disabled:opacity-50 flex items-center justify-center space-x-2">
                                </button>
                                <p id="formAnggotaMessage" class="col-span-3 text-sm text-center hidden"></p>
                            </form>
                        </div>

                        <!-- Bagian Pencarian dan Daftar Anggota -->
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-xl">
                            <h2 class="text-2xl font-semibold text-yellow-700 mb-4 flex items-center space-x-2">
                                <i data-lucide="list-video" class="w-6 h-6"></i>
                                <span>Daftar Anggota</span>
                            </h2>
                            <input type="text" id="searchAnggota" placeholder="Cari berdasarkan Nama, Jabatan, atau Divisi..."
                                class="w-full p-3 mb-6 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">

                            <!-- Tabel Anggota -->
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 min-w-max">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th onclick="handleHeaderSortClick('nama', 'anggota')" data-sort-key="nama" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Nama <span class="sort-icon-wrapper anggota" data-col="nama"></span></th>
                                            <th onclick="handleHeaderSortClick('batch', 'anggota')" data-sort-key="batch" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Batch <span class="sort-icon-wrapper anggota" data-col="batch"></span></th>
                                            <th onclick="handleHeaderSortClick('jabatan', 'anggota')" data-sort-key="jabatan" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Jabatan <span class="sort-icon-wrapper anggota" data-col="jabatan"></span></th>
                                            <th onclick="handleHeaderSortClick('divisi', 'anggota')" data-sort-key="divisi" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Divisi <span class="sort-icon-wrapper anggota" data-col="divisi"></span></th>
                                            <th onclick="handleHeaderSortClick('angkatan', 'anggota')" data-sort-key="angkatan" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Angkatan <span class="sort-icon-wrapper anggota" data-col="angkatan"></span></th>
                                            <th onclick="handleHeaderSortClick('tanggal_lahir', 'anggota')" data-sort-key="tanggal_lahir" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Tgl Lahir <span class="sort-icon-wrapper anggota" data-col="tanggal_lahir"></span></th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No. HP</th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Org Lain</th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">CV Link</th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="anggotaList" class="bg-white divide-y divide-gray-200">
                                        <!-- Data anggota akan dimasukkan di sini oleh JavaScript -->
                                    </tbody>
                                </table>
                                <p id="noAnggotaDataMessage" class="hidden p-4 text-center text-gray-500 mt-4">Tidak ada anggota yang ditemukan.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW 4: MANAJEMEN ALUMNI (BARU) -->
                <div id="alumniView" class="view-content hidden space-y-4">
                    <div class="main-page-header">
                        <h1 class="text-3xl font-bold text-gray-800 flex items-center p-0">
                            <i data-lucide="graduation-cap" class="w-8 h-8 mr-3 text-yellow-600"></i>
                            Data Alumni Hexacomm
                        </h1>
                        <p class="text-sm text-gray-500 mt-1 pl-11">Arsip dan kelola data alumni Hexacomm.</p>
                    </div>

                    <div class="view-background-texture space-y-8 p-6">
                        
                        <!-- Form Tambah Alumni -->
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-xl border-t-4 border-yellow-500">
                            <h2 class="text-2xl font-semibold text-yellow-700 mb-4 flex items-center space-x-2">
                                <i data-lucide="briefcase-business" class="w-6 h-6"></i>
                                <span>Tambah Data Alumni</span>
                            </h2>
                            <form id="alumniForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <input type="text" id="alumni_nama" placeholder="Nama Lengkap (Wajib)" required class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                                <input type="text" id="alumni_batch" placeholder="Batch (Ex: B0)" class="p-3 border border-gray-300 rounded-lg">
                                <input type="number" id="alumni_angkatan" placeholder="Angkatan (Ex: 2020)" min="2010" max="2100" class="p-3 border border-gray-300 rounded-lg">
                                <input type="text" id="alumni_bidang" placeholder="Bidang/Jurusan" class="p-3 border border-gray-300 rounded-lg">
                                <input type="text" id="alumni_tempat_kerja" placeholder="Tempat Kerja Saat Ini" class="col-span-1 md:col-span-2 p-3 border border-gray-300 rounded-lg">
                                <input type="tel" id="alumni_no_handphone" placeholder="No. Handphone" class="p-3 border border-gray-300 rounded-lg">
                                <input type="email" id="alumni_email" placeholder="Email" class="p-3 border border-gray-300 rounded-lg">
                                <input type="url" id="alumni_link_cv" placeholder="Link CV/Portofolio (URL)" class="p-3 border border-gray-300 rounded-lg">

                                <button type="submit" id="submitAlumniButton"
                                    class="col-span-1 md:col-span-3 bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300 shadow-xl shadow-yellow-400/50 disabled:opacity-50 flex items-center justify-center space-x-2">
                                </button>
                                <p id="formAlumniMessage" class="col-span-3 text-sm text-center hidden"></p>
                            </form>
                        </div>

                        <!-- Bagian Pencarian dan Daftar Alumni -->
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-xl">
                            <h2 class="text-2xl font-semibold text-yellow-700 mb-4 flex items-center space-x-2">
                                <i data-lucide="users-round" class="w-6 h-6"></i>
                                <span>Daftar Alumni</span>
                            </h2>
                            <input type="text" id="searchAlumni" placeholder="Cari berdasarkan Nama, Tempat Kerja, atau Bidang..."
                                class="w-full p-3 mb-6 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">

                            <!-- Tabel Alumni -->
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 min-w-max">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th onclick="handleHeaderSortClick('nama', 'alumni')" data-sort-key="nama" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Nama <span class="sort-icon-wrapper alumni" data-col="nama"></span></th>
                                            <th onclick="handleHeaderSortClick('batch', 'alumni')" data-sort-key="batch" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Batch <span class="sort-icon-wrapper alumni" data-col="batch"></span></th>
                                            <th onclick="handleHeaderSortClick('angkatan', 'alumni')" data-sort-key="angkatan" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Angkatan <span class="sort-icon-wrapper alumni" data-col="angkatan"></span></th>
                                            <th onclick="handleHeaderSortClick('bidang', 'alumni')" data-sort-key="bidang" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Bidang <span class="sort-icon-wrapper alumni" data-col="bidang"></span></th>
                                            <th onclick="handleHeaderSortClick('tempat_kerja', 'alumni')" data-sort-key="tempat_kerja" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 sortable-header">Tempat Kerja <span class="sort-icon-wrapper alumni" data-col="tempat_kerja"></span></th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">No. HP</th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">CV Link</th>
                                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="alumniList" class="bg-white divide-y divide-gray-200">
                                        <!-- Data alumni akan dimasukkan di sini oleh JavaScript -->
                                    </tbody>
                                </table>
                                <p id="noAlumniDataMessage" class="hidden p-4 text-center text-gray-500 mt-4">Tidak ada alumni yang ditemukan.</p>
                            </div>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>

    <!-- MODALS (Paper dan Materi Existing, Anggota dan Alumni Baru) -->
    
    <!-- MODAL EDIT PAPER (EXISTING) -->
    <div id="editModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="text-2xl font-bold text-yellow-700 mb-4 flex items-center space-x-2 border-b pb-2">
                <i data-lucide="file-edit" class="w-6 h-6"></i>
                <span>Edit Detail Paper</span>
            </h3>
            <button onclick="closeEditModal('paper')" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <form id="editPaperForm" class="space-y-4">
                <input type="hidden" id="edit-id-paper">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1">Judul Paper (ID)</label>
                        <p id="edit-title-display-paper" class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg font-semibold text-gray-800 truncate"></p>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-deadline-paper">Deadline</label>
                        <input type="date" id="edit-deadline-paper"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </div>

                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-authors-paper">Penulis</label>
                        <input type="text" id="edit-authors-paper" placeholder="Nama Penulis (Pisahkan dengan koma)"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-reference_link-paper">Link Referensi</label>
                        <input type="url" id="edit-reference_link-paper" placeholder="Link Referensi (URL)"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </div>

                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-status-paper">Status (Wajib)</label>
                        <select id="edit-status-paper" required
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                            <option value="Draft">Draft</option>
                            <option value="Submitted">Submitted</option>
                            <option value="Under Review">Under Review</option>
                            <option value="Accepted">Accepted</option>
                            <option value="Rejected">Rejected</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-overleaf_link-paper">Link Overleaf</label>
                        <input type="url" id="edit-overleaf_link-paper" placeholder="Link Overleaf (URL)"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </div>

                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-category-paper">Kategori</label>
                        <input type="text" id="edit-category-paper" placeholder="Kategori (Jurnal/Konferensi/Lainnya)"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-ppt_link-paper">Link PPT/Slide</label>
                        <input type="url" id="edit-ppt_link-paper" placeholder="Link PPT/Slide (URL)"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </div>
                </div>

                <p id="editFormPaperMessage" class="text-sm text-center font-semibold hidden"></p>

                <button type="submit" id="saveEditPaperButton"
                    class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg transition duration-300 shadow-md disabled:opacity-50 flex items-center justify-center space-x-2">
                    <i data-lucide="check" class="w-5 h-5"></i> <span>Simpan Perubahan</span>
                </button>
            </form>
        </div>
    </div>
    
    <!-- MODAL EDIT MATERI (EXISTING) -->
    <div id="editMateriModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="text-2xl font-bold text-yellow-700 mb-4 flex items-center space-x-2 border-b pb-2">
                <i data-lucide="file-edit" class="w-6 h-6"></i>
                <span>Edit Detail Materi</span>
            </h3>
            <button onclick="closeEditModal('materi')" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <form id="editMateriForm" class="space-y-4">
                <input type="hidden" id="edit-id-materi">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1">Judul Materi</label>
                        <input type="text" id="edit-judul_materi" placeholder="Judul Materi (Wajib)" required
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-divisi">Divisi (Wajib)</label>
                        <select id="edit-divisi" required
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                            <option value="5G">5G</option>
                            <option value="IoT">IoT</option>
                            <option value="Umum">Umum</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-pembuat">Pembuat</label>
                        <input type="text" id="edit-pembuat" placeholder="Nama Pembuat"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-tanggal_jadi">Tanggal Jadi</label>
                        <input type="date" id="edit-tanggal_jadi" placeholder="Tanggal Jadi"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </div>
                </div>

                <!-- Link Materi (Full width) -->
                <div>
                    <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-link_materi">Link Materi (Wajib)</label>
                    <input type="url" id="edit-link_materi" placeholder="Link Materi (URL)" required
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-bold mb-1" for="edit-ppt_link_materi">Link PPT/Slide</label>
                    <input type="url" id="edit-ppt_link_materi" placeholder="Link PPT/Slide (URL)"
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                </div>

                <p id="editFormMateriMessage" class="text-sm text-center font-semibold hidden"></p>

                <button type="submit" id="saveEditMateriButton"
                    class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg transition duration-300 shadow-md disabled:opacity-50 flex items-center justify-center space-x-2">
                    <i data-lucide="check" class="w-5 h-5"></i> <span>Simpan Perubahan Materi</span>
                </button>
            </form>
        </div>
    </div>

    <!-- MODAL EDIT ANGGOTA (BARU) -->
    <div id="editAnggotaModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="text-2xl font-bold text-yellow-700 mb-4 flex items-center space-x-2 border-b pb-2">
                <i data-lucide="user-edit" class="w-6 h-6"></i>
                <span>Edit Detail Anggota</span>
            </h3>
            <button onclick="closeEditModal('anggota')" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <form id="editAnggotaForm" class="space-y-4">
                <input type="hidden" id="edit-id-anggota">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <input type="text" id="edit-anggota_nama" placeholder="Nama Lengkap (Wajib)" required class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    <input type="text" id="edit-anggota_batch" placeholder="Batch (Ex: B1)" class="p-3 border border-gray-300 rounded-lg">
                    <input type="number" id="edit-anggota_angkatan" placeholder="Angkatan (Ex: 2021)" min="2010" max="2100" class="p-3 border border-gray-300 rounded-lg">
                    
                    <select id="edit-anggota_jabatan" required class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </select>
                    <select id="edit-anggota_divisi" required class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    </select>
                    
                    <input type="email" id="edit-anggota_email" placeholder="Email" class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    <input type="tel" id="edit-anggota_no_handphone" placeholder="No. Handphone" class="p-3 border border-gray-300 rounded-lg">
                    <input type="date" id="edit-anggota_tanggal_lahir" placeholder="Tanggal Lahir" class="p-3 border border-gray-300 rounded-lg">
                    <input type="text" id="edit-anggota_organisasi_lain" placeholder="Organisasi Lain" class="p-3 border border-gray-300 rounded-lg">
                    <input type="url" id="edit-anggota_link_cv" placeholder="Link CV/Portofolio (URL)" class="col-span-1 md:col-span-2 p-3 border border-gray-300 rounded-lg">

                </div>

                <p id="editFormAnggotaMessage" class="text-sm text-center font-semibold hidden"></p>

                <button type="submit" id="saveEditAnggotaButton"
                    class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg transition duration-300 shadow-md disabled:opacity-50 flex items-center justify-center space-x-2">
                    <i data-lucide="check" class="w-5 h-5"></i> <span>Simpan Perubahan Anggota</span>
                </button>
            </form>
        </div>
    </div>

    <!-- MODAL EDIT ALUMNI (BARU) -->
    <div id="editAlumniModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="text-2xl font-bold text-yellow-700 mb-4 flex items-center space-x-2 border-b pb-2">
                <i data-lucide="archive" class="w-6 h-6"></i>
                <span>Edit Data Alumni</span>
            </h3>
            <button onclick="closeEditModal('alumni')" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <form id="editAlumniForm" class="space-y-4">
                <input type="hidden" id="edit-id-alumni">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <input type="text" id="edit-alumni_nama" placeholder="Nama Lengkap (Wajib)" required class="p-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500">
                    <input type="text" id="edit-alumni_batch" placeholder="Batch (Ex: B0)" class="p-3 border border-gray-300 rounded-lg">
                    <input type="number" id="edit-alumni_angkatan" placeholder="Angkatan (Ex: 2020)" min="2010" max="2100" class="p-3 border border-gray-300 rounded-lg">
                    <input type="text" id="edit-alumni_bidang" placeholder="Bidang/Jurusan" class="p-3 border border-gray-300 rounded-lg">
                    <input type="text" id="edit-alumni_tempat_kerja" placeholder="Tempat Kerja Saat Ini" class="col-span-1 md:col-span-2 p-3 border border-gray-300 rounded-lg">
                    <input type="tel" id="edit-alumni_no_handphone" placeholder="No. Handphone" class="p-3 border border-gray-300 rounded-lg">
                    <input type="email" id="edit-alumni_email" placeholder="Email" class="p-3 border border-gray-300 rounded-lg">
                    <input type="url" id="edit-alumni_link_cv" placeholder="Link CV/Portofolio (URL)" class="p-3 border border-gray-300 rounded-lg">
                </div>

                <p id="editFormAlumniMessage" class="text-sm text-center font-semibold hidden"></p>

                <button type="submit" id="saveEditAlumniButton"
                    class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg transition duration-300 shadow-md disabled:opacity-50 flex items-center justify-center space-x-2">
                    <i data-lucide="check" class="w-5 h-5"></i> <span>Simpan Perubahan Alumni</span>
                </button>
            </form>
        </div>
    </div>


    <!-- Supabase Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        // --- KONFIGURASI ASET ---
        const LOGO_URL = 'https://raw.githubusercontent.com/fitrasadli/pantaupaper/main/Logo%20Hexacomm.png'; 

        // --- KONFIGURASI SUPABASE (UPDATED) ---
        const SUPABASE_URL = 'https://wqqqilascgnntonwswha.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_dvGcqxfy3CtBypmOm0g5eQ__nMm3ghP';
        
        const TABLE_NAME_PAPER = 'papers';
        const TABLE_NAME_MATERI = 'materi';
        const TABLE_NAME_ANGGOTA = 'anggota_hexacomm'; // BARU
        const TABLE_NAME_ALUMNI = 'alumni'; // BARU
        const USER_TABLE_NAME = 'users';

        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // --- PILIHAN DROPDOWN (BARU) ---
        const JABATAN_OPTIONS = [
            "Ketua", "Wakil Ketua",
            "Koor Sekretaris", "Staff Sekretaris",
            "Koor Bendahara", "Staff Bendahara",
            "Koor RnD", "Staff RnD",
            "Koor HRD", "Staff HRD",
            "Koor PR", "Staff PR"
        ];
        const DIVISI_OPTIONS = ["5G", "IoT", "Umum"];

        // --- REFERENSI DOM ---
        const loginSection = document.getElementById('loginSection');
        const appSection = document.getElementById('appSection');
        const loginForm = document.getElementById('loginForm');
        const loginError = document.getElementById('loginError');
        const logoutButton = document.getElementById('logoutButton');
        const loginLogo = document.getElementById('loginLogo');
        const headerLogo = document.getElementById('headerLogo');

        // Navigasi & View
        const mainNav = document.getElementById('mainNav');
        const paperView = document.getElementById('paperView');
        const materiView = document.getElementById('materiView');
        const anggotaView = document.getElementById('anggotaView'); // BARU
        const alumniView = document.getElementById('alumniView'); // BARU

        // Paper Elements (Existing)
        const papersList = document.getElementById('papersList');
        const paperForm = document.getElementById('paperForm');
        const searchPaperInput = document.getElementById('searchPaper');
        const noPaperDataMessage = document.getElementById('noPaperDataMessage');
        const formPaperMessage = document.getElementById('formPaperMessage');
        const submitPaperButton = document.getElementById('submitPaperButton');
        const editModal = document.getElementById('editModal');
        const editPaperForm = document.getElementById('editPaperForm');
        const editFormPaperMessage = document.getElementById('editFormPaperMessage');
        const saveEditPaperButton = document.getElementById('saveEditPaperButton');

        // Materi Elements (Existing)
        const materiList = document.getElementById('materiList');
        const materiForm = document.getElementById('materiForm');
        const searchMateriInput = document.getElementById('searchMateri');
        const noMateriDataMessage = document.getElementById('noMateriDataMessage');
        const formMateriMessage = document.getElementById('formMateriMessage');
        const submitMateriButton = document.getElementById('submitMateriButton');
        const editMateriModal = document.getElementById('editMateriModal');
        const editMateriForm = document.getElementById('editMateriForm');
        const editFormMateriMessage = document.getElementById('editFormMateriMessage');
        const saveEditMateriButton = document.getElementById('saveEditMateriButton');

        // Anggota Elements (BARU)
        const anggotaList = document.getElementById('anggotaList');
        const anggotaForm = document.getElementById('anggotaForm');
        const searchAnggotaInput = document.getElementById('searchAnggota');
        const noAnggotaDataMessage = document.getElementById('noAnggotaDataMessage');
        const formAnggotaMessage = document.getElementById('formAnggotaMessage');
        const submitAnggotaButton = document.getElementById('submitAnggotaButton');
        const editAnggotaModal = document.getElementById('editAnggotaModal');
        const editAnggotaForm = document.getElementById('editAnggotaForm');
        const editFormAnggotaMessage = document.getElementById('editFormAnggotaMessage');
        const saveEditAnggotaButton = document.getElementById('saveEditAnggotaButton');

        // Alumni Elements (BARU)
        const alumniList = document.getElementById('alumniList');
        const alumniForm = document.getElementById('alumniForm');
        const searchAlumniInput = document.getElementById('searchAlumni');
        const noAlumniDataMessage = document.getElementById('noAlumniDataMessage');
        const formAlumniMessage = document.getElementById('formAlumniMessage');
        const submitAlumniButton = document.getElementById('submitAlumniButton');
        const editAlumniModal = document.getElementById('editAlumniModal');
        const editAlumniForm = document.getElementById('editAlumniForm');
        const editFormAlumniMessage = document.getElementById('editFormAlumniMessage');
        const saveEditAlumniButton = document.getElementById('saveEditAlumniButton');

        // Status Sorting Global (Dipisahkan berdasarkan jenis)
        const sortState = {
            paper: { col: 'created_at', order: 'desc' },
            materi: { col: 'created_at', order: 'desc' },
            anggota: { col: 'nama', order: 'asc' }, // Default sort by name
            alumni: { col: 'angkatan', order: 'desc' } // Default sort by angkatan
        };
        
        let currentActiveView = 'paper'; // Default view saat login

        // --- ROLE PERMISSIONS (BARU) ---
        function applyPermissions() {
            const role = sessionStorage.getItem('userRole') || 'viewer';
            
            // Mencari container form (div dengan bg-white)
            const paperContainer = paperForm ? paperForm.parentElement : null;
            const materiContainer = materiForm ? materiForm.parentElement : null;
            const anggotaContainer = anggotaForm ? anggotaForm.parentElement : null;
            const alumniContainer = alumniForm ? alumniForm.parentElement : null;

            const containers = [paperContainer, materiContainer, anggotaContainer, alumniContainer];

            if (role !== 'admin') {
                // Sembunyikan form tambah data jika bukan admin
                containers.forEach(c => {
                    if (c) c.classList.add('hidden');
                });
            } else {
                // Tampilkan jika dia admin
                containers.forEach(c => {
                    if (c) c.classList.remove('hidden');
                });
            }
        }

        // --- LOGIKA UTILITY ---
        function renderButtonContent(text, icon = 'file-plus') {
            const spinClass = icon === 'loader-circle' ? 'animate-spin-fast' : '';
            return `<i data-lucide="${icon}" class="w-5 h-5 mr-2 ${spinClass}"></i> <span>${text}</span>`;
        }

        function showMessage(element, message, colorClass) {
            if (!element) return;
            element.textContent = message;
            element.className = `col-span-3 text-sm text-center font-semibold ${colorClass}`;
            element.classList.remove('hidden');
            setTimeout(() => {
                element.classList.add('hidden');
            }, 4000);
        }

        // Helper untuk mengisi dropdown
        function populateSelect(selectElement, options, currentValue = '') {
            if (!selectElement) return;
            selectElement.innerHTML = `<option value="" disabled ${currentValue ? '' : 'selected'}>Pilih...</option>`;
            options.forEach(option => {
                const isSelected = option === currentValue ? 'selected' : '';
                selectElement.innerHTML += `<option value="${option}" ${isSelected}>${option}</option>`;
            });
        }


        // --- LOGIKA NAVIGASI DAN VIEW --- 
        
        function showView(viewName) {
            currentActiveView = viewName;
            
            // Sembunyikan semua view dan reset navigasi
            document.querySelectorAll('.view-content').forEach(view => {
                if (view) view.classList.add('hidden');
            });
            document.querySelectorAll('.nav-item').forEach(nav => {
                if (nav) {
                    nav.classList.remove('nav-item-active');
                    nav.classList.add('nav-item-inactive');
                }
            });

            // Tampilkan view yang sesuai dan atur status navigasi
            const targetView = document.getElementById(`${viewName}View`);
            const targetNav = document.getElementById(`nav-${viewName}`);

            if (targetView) targetView.classList.remove('hidden');
            if (targetNav) {
                targetNav.classList.add('nav-item-active');
                targetNav.classList.remove('nav-item-inactive');
            }

            // Muat data untuk view yang aktif
            const getSearchTerm = (input) => input ? input.value : '';

            if (viewName === 'paper') {
                fetchPapers(getSearchTerm(searchPaperInput));
            } else if (viewName === 'materi') {
                fetchMateri(getSearchTerm(searchMateriInput));
            } else if (viewName === 'anggota') { // BARU
                fetchAnggota(getSearchTerm(searchAnggotaInput));
            } else if (viewName === 'alumni') { // BARU
                fetchAlumni(getSearchTerm(searchAlumniInput));
            }
            lucide.createIcons(); // Re-render icons
        }
        
        mainNav && mainNav.addEventListener('click', (e) => {
            const navItem = e.target.closest('.nav-item');
            if (navItem) {
                const view = navItem.getAttribute('data-view');
                showView(view);
            }
        });

        // --- LOGIKA SORTING HEADER ---
        function updateTableHeaders(type) {
            document.querySelectorAll(`.sort-icon-wrapper.${type}`).forEach(wrapper => {
                if (wrapper) wrapper.innerHTML = '';
            });

            const state = sortState[type];
            const icon = state.order === 'asc' ? 'arrow-up' : 'arrow-down';
            
            const activeWrapper = document.querySelector(`.sort-icon-wrapper.${type}[data-col="${state.col}"]`);
            if (activeWrapper) {
                activeWrapper.innerHTML = `<i data-lucide="${icon}" class="w-3 h-3 text-yellow-600"></i>`;
                lucide.createIcons();
            }
        }

        window.handleHeaderSortClick = (column, type) => {
            const state = sortState[type];
            
            if (state.col === column) {
                state.order = state.order === 'asc' ? 'desc' : 'asc';
            } else {
                state.col = column;
                state.order = 'asc'; 
            }

            const getSearchTerm = (input) => input ? input.value : '';

            if (type === 'paper') {
                fetchPapers(getSearchTerm(searchPaperInput));
            } else if (type === 'materi') {
                fetchMateri(getSearchTerm(searchMateriInput));
            } else if (type === 'anggota') { // BARU
                fetchAnggota(getSearchTerm(searchAnggotaInput));
            } else if (type === 'alumni') { // BARU
                fetchAlumni(getSearchTerm(searchAlumniInput));
            }
            updateTableHeaders(type);
        };

        // --- LOGIKA LOGIN ---
        function setLogos() {
            if (loginLogo) loginLogo.src = LOGO_URL;
            if (headerLogo) headerLogo.src = LOGO_URL; 
        }

        function checkSession() {
            setLogos();
            const isLoggedIn = sessionStorage.getItem('isLoggedIn');
            if (isLoggedIn === 'true') {
                showApp();
                showView(currentActiveView);
            } else {
                showLogin();
            }
        }

        function showLogin() {
            if (loginSection) loginSection.classList.remove('flex-grow', 'hidden');
            if (appSection) appSection.classList.add('hidden');
        }

        function showApp() {
            if (loginSection) loginSection.classList.add('hidden');
            if (appSection) appSection.classList.remove('hidden');
            applyPermissions(); // TERAPKAN IZIN AKSES SAAT APP DIBUKA
        }

        loginForm && loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const user = document.getElementById('username').value;
            const pass = document.getElementById('password').value;
            const submitBtn = loginForm.querySelector('button[type="submit"]');

            const originalText = submitBtn.innerText;
            submitBtn.disabled = true;
            submitBtn.innerText = "Memeriksa...";
            if (loginError) loginError.classList.add('hidden');

            try {
                const { data, error } = await supabaseClient
                    .from(USER_TABLE_NAME)
                    .select('*')
                    .eq('username', user)
                    .eq('password', pass)
                    .maybeSingle();

                if (error) throw error;

                if (data) {
                    sessionStorage.setItem('isLoggedIn', 'true');
                    sessionStorage.setItem('userRole', data.role || 'viewer'); // SIMPAN ROLE DI SINI
                    showApp();
                    showView(currentActiveView);
                } else {
                    throw new Error("Username atau Password salah!");
                }
            } catch (err) {
                console.error("Login error:", err);
                let errorMessage = "Terjadi kesalahan saat login.";
                if (err.message) {
                    if (err.message.includes('relation "users" does not exist')) {
                        errorMessage = "Error: Tabel 'users' belum dibuat di database.";
                    } else if (err.message.includes('Username atau Password salah')) {
                        errorMessage = err.message;
                    } else {
                        errorMessage = "Terjadi kesalahan koneksi. Periksa konsol untuk detail.";
                    }
                }
                if (loginError) {
                    loginError.textContent = errorMessage;
                    loginError.classList.remove('hidden');
                }
            } finally {
                if (submitBtn) submitBtn.disabled = false;
                if (submitBtn) submitBtn.innerText = originalText;
            }
        });

        logoutButton && logoutButton.addEventListener('click', () => {
            sessionStorage.removeItem('isLoggedIn');
            sessionStorage.removeItem('userRole');
            window.location.reload(); 
        });

        // --- LOGIKA UTAMA (PAPER & MATERI) ---

        // Paper
        function getStatusBadge(status) {
            let color = '';
            let icon = '';
            switch (status) {
                case 'Draft': color = 'bg-yellow-100 text-yellow-800 border border-yellow-300'; icon = 'pencil'; break;
                case 'Submitted': color = 'bg-blue-100 text-blue-800 border border-blue-300'; icon = 'send'; break;
                case 'Under Review': color = 'bg-purple-100 text-purple-800 border border-purple-300'; icon = 'search'; break;
                case 'Accepted': color = 'bg-green-100 text-green-800 border border-green-300'; icon = 'check-circle'; break;
                case 'Rejected': color = 'bg-red-100 text-red-800 border border-red-300'; icon = 'x-circle'; break;
                default: color = 'bg-gray-100 text-gray-800 border border-gray-300'; icon = 'file';
            }
            return `<span class="px-3 py-1 inline-flex text-xs leading-5 font-bold rounded-full items-center space-x-1 ${color}"><i data-lucide="${icon}" class="w-3 h-3"></i><span>${status}</span></span>`;
        }

        function createPaperRow(paper) {
            const deadlineDate = paper.deadline ? new Date(paper.deadline).toLocaleDateString('id-ID', { year: 'numeric', month: 'short', day: 'numeric' }) : '-';
            const paperJson = JSON.stringify(paper).replace(/'/g, "\\'");
            const role = sessionStorage.getItem('userRole');

            const linkIcon = (url, iconName, label) => {
                if (!url) return '';
                const safeUrl = url.startsWith('http') || url.startsWith('https') ? url : `https://${url}`;
                return `
                    <a href="${safeUrl}" target="_blank" rel="noopener noreferrer" 
                        class="p-1 rounded-full border border-yellow-200 bg-yellow-50 text-yellow-600 hover:bg-yellow-200 hover:border-yellow-400 transition duration-200 shadow-sm" 
                        title="${label}">
                        <i data-lucide="${iconName}" class="w-4 h-4"></i>
                    </a>
                `;
            };

            const links = `
                ${linkIcon(paper.reference_link, 'link', 'Link Referensi')}
                ${linkIcon(paper.overleaf_link, 'file-text', 'Link Overleaf')}
                ${linkIcon(paper.ppt_link, 'monitor', 'Link PPT')}
            `;

            const editButton = (role === 'admin') ? `
                <button onclick='openEditModal("paper", ${paperJson})'
                    class="p-1 rounded-full border border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-200 hover:border-blue-400 transition duration-200 shadow-sm" 
                    title="Edit Paper">
                    <i data-lucide="edit-3" class="w-4 h-4"></i>
                </button>
            ` : '';

            return `
                <tr class="hover:bg-yellow-50 transition duration-150">
                    <td class="px-3 py-4 whitespace-normal text-sm font-medium text-gray-900">${paper.title}</td>
                    <td class="px-3 py-4 whitespace-normal text-sm text-gray-500">${paper.authors || '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm">${getStatusBadge(paper.status)}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-500 hidden sm:table-cell">${paper.category || '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-500 hidden sm:table-cell">${deadlineDate}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700 flex space-x-1 items-center">
                        ${links}
                        ${editButton}
                    </td>
                </tr>
            `;
        }
        async function fetchPapers(searchTerm = '') {
            if (!papersList || !noPaperDataMessage) return;
            noPaperDataMessage.classList.add('hidden');
            const state = sortState.paper;
            papersList.innerHTML = `<tr><td colspan="6" class="p-4 text-center text-gray-500 flex items-center justify-center"><i data-lucide="loader-circle" class="w-5 h-5 mr-2 animate-spin-fast"></i>Memuat data paper...</td></tr>`;
            lucide.createIcons();
            updateTableHeaders('paper');

            try {
                let query = supabaseClient.from(TABLE_NAME_PAPER).select('*').order(state.col, { ascending: state.order === 'asc' }); 
                if (searchTerm) {
                    const searchPattern = `%${searchTerm.toLowerCase()}%`;
                    query = query.or(`title.ilike.${searchPattern},authors.ilike.${searchPattern}`);
                }
                const { data, error } = await query;
                if (error) { throw error; }

                papersList.innerHTML = '';
                if (data && data.length > 0) {
                    data.forEach(paper => { papersList.insertAdjacentHTML('beforeend', createPaperRow(paper)); });
                    lucide.createIcons(); 
                } else {
                    noPaperDataMessage.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Final fetching paper error:', error.message);
                let errorMessage = error.message.includes('permission denied') ? `Akses Ditolak (RLS Error). Cek RLS tabel '${TABLE_NAME_PAPER}'.` : `Gagal memuat data: ${error.message}`;
                papersList.innerHTML = `<tr><td colspan="6" class="p-4 text-center text-red-500 font-bold">${errorMessage}</td></tr>`;
            }
        }
        paperForm && paperForm.addEventListener('submit', async (event) => { 
            event.preventDefault();
            const newPaper = {
                title: document.getElementById('title').value.trim(),
                authors: document.getElementById('authors').value.trim() || null,
                status: document.getElementById('status').value,
                category: document.getElementById('category').value.trim() || null,
                deadline: document.getElementById('deadline').value || null,
                reference_link: document.getElementById('reference_link').value.trim() || null,
                overleaf_link: document.getElementById('overleaf_link').value.trim() || null,
                ppt_link: document.getElementById('ppt_link').value.trim() || null,
            };

            if (!newPaper.title || !newPaper.status) {
                showMessage(formPaperMessage, 'Judul dan Status wajib diisi!', 'text-red-500');
                return;
            }

            if (submitPaperButton) submitPaperButton.disabled = true;
            if (submitPaperButton) submitPaperButton.innerHTML = renderButtonContent('Menyimpan...', 'loader-circle');
            lucide.createIcons();

            try {
                const { error } = await supabaseClient.from(TABLE_NAME_PAPER).insert([newPaper]);
                if (error) throw error;
                paperForm.reset();
                showMessage(formPaperMessage, 'Paper berhasil ditambahkan!', 'text-green-500');
                fetchPapers(searchPaperInput ? searchPaperInput.value : '');
            } catch (error) {
                console.error('Error adding paper:', error.message);
                let errorMessage = error.message.includes('permission denied') ? `Gagal menambahkan paper: Akses Ditolak (RLS Error).` : `Gagal menambahkan paper: ${error.message}`;
                showMessage(formPaperMessage, errorMessage, 'text-red-500');
            } finally {
                if (submitPaperButton) submitPaperButton.disabled = false;
                if (submitPaperButton) submitPaperButton.innerHTML = renderButtonContent('Tambah Paper', 'file-plus');
                lucide.createIcons();
            }
        });
        editPaperForm && editPaperForm.addEventListener('submit', async (e) => { 
             e.preventDefault();
            const paperId = document.getElementById('edit-id-paper').value;
            const updatedPaper = {
                authors: document.getElementById('edit-authors-paper').value.trim() || null,
                status: document.getElementById('edit-status-paper').value,
                category: document.getElementById('edit-category-paper').value.trim() || null,
                deadline: document.getElementById('edit-deadline-paper').value || null,
                reference_link: document.getElementById('edit-reference_link-paper').value.trim() || null,
                overleaf_link: document.getElementById('edit-overleaf_link-paper').value.trim() || null,
                ppt_link: document.getElementById('edit-ppt_link-paper').value.trim() || null,
            };

            if (saveEditPaperButton) saveEditPaperButton.disabled = true;
            if (saveEditPaperButton) saveEditPaperButton.innerHTML = renderButtonContent('Menyimpan...', 'loader-circle');
            lucide.createIcons();

            try {
                const { error } = await supabaseClient.from(TABLE_NAME_PAPER).update(updatedPaper).eq('id', paperId);
                if (error) throw error;
                showMessage(editFormPaperMessage, 'Perubahan berhasil disimpan!', 'text-green-500');
                fetchPapers(searchPaperInput ? searchPaperInput.value : '');
                setTimeout(closeEditModal.bind(null, 'paper'), 1000);
            } catch (error) {
                console.error('Error updating paper:', error.message);
                let errorMessage = error.message.includes('permission denied') ? `Gagal menyimpan: Akses Ditolak (RLS Error).` : `Gagal menyimpan: ${error.message}`;
                showMessage(editFormPaperMessage, errorMessage, 'text-red-500');
            } finally {
                if (saveEditPaperButton) saveEditPaperButton.disabled = false;
                if (saveEditPaperButton) saveEditPaperButton.innerHTML = renderButtonContent('Simpan Perubahan', 'check');
                lucide.createIcons();
            }
        });

        // Materi
        function createMateriRow(materi) {
            const tanggalJadi = materi.tanggal_jadi ? new Date(materi.tanggal_jadi).toLocaleDateString('id-ID', { year: 'numeric', month: 'short', day: 'numeric' }) : '-';
            const materiJson = JSON.stringify(materi).replace(/'/g, "\\'");
            const role = sessionStorage.getItem('userRole');

            const badgeColor = materi.divisi === '5G' ? 'bg-indigo-100 text-indigo-800' : 
                                materi.divisi === 'IoT' ? 'bg-cyan-100 text-cyan-800' : 'bg-gray-100 text-gray-800';

            const linkIcon = (url, iconName, label) => {
                if (!url) return '';
                const safeUrl = url.startsWith('http') || url.startsWith('https') ? url : `https://${url}`;
                return `
                    <a href="${safeUrl}" target="_blank" rel="noopener noreferrer" 
                        class="p-1 rounded-full border border-yellow-200 bg-yellow-50 text-yellow-600 hover:bg-yellow-200 hover:border-yellow-400 transition duration-200 shadow-sm" 
                        title="${label}">
                        <i data-lucide="${iconName}" class="w-4 h-4"></i>
                    </a>
                `;
            };

            const links = `
                ${linkIcon(materi.link_materi, 'link', 'Link Materi Utama')}
                ${linkIcon(materi.ppt_link_materi, 'monitor', 'Link PPT/Slide')}
            `;

            const editButton = (role === 'admin') ? `
                <button onclick='openEditModal("materi", ${materiJson})'
                    class="p-1 rounded-full border border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-200 hover:border-blue-400 transition duration-200 shadow-sm" 
                    title="Edit Materi">
                    <i data-lucide="edit-3" class="w-4 h-4"></i>
                </button>
            ` : '';

            return `
                <tr class="hover:bg-yellow-50 transition duration-150">
                    <td class="px-3 py-4 whitespace-normal text-sm font-medium text-gray-900">${materi.judul_materi}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm">
                        <span class="px-3 py-1 inline-flex text-xs leading-5 font-bold rounded-full ${badgeColor}">
                            ${materi.divisi}
                        </span>
                    </td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-500 hidden sm:table-cell">${materi.pembuat || '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-500 hidden sm:table-cell">${tanggalJadi}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700 flex space-x-1 items-center">
                        ${links}
                        ${editButton}
                    </td>
                </tr>
            `;
        }
        async function fetchMateri(searchTerm = '') {
            if (!materiList || !noMateriDataMessage) return;
            noMateriDataMessage.classList.add('hidden');
            const state = sortState.materi;
            materiList.innerHTML = `<tr><td colspan="5" class="p-4 text-center text-gray-500 flex items-center justify-center"><i data-lucide="loader-circle" class="w-5 h-5 mr-2 animate-spin-fast"></i>Memuat data materi...</td></tr>`;
            lucide.createIcons();
            updateTableHeaders('materi');

            try {
                let query = supabaseClient.from(TABLE_NAME_MATERI).select('*, ppt_link_materi').order(state.col, { ascending: state.order === 'asc' });
                if (searchTerm) {
                    const searchPattern = `%${searchTerm.toLowerCase()}%`;
                    query = query.or(`judul_materi.ilike.${searchPattern},pembuat.ilike.${searchPattern}`);
                }
                const { data, error } = await query;
                if (error) { throw error; }

                materiList.innerHTML = '';
                if (data && data.length > 0) {
                    data.forEach(materi => { materiList.insertAdjacentHTML('beforeend', createMateriRow(materi)); });
                    lucide.createIcons();
                } else {
                    noMateriDataMessage.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Final fetching materi error:', error.message);
                let errorMessage = error.message.includes('relation "materi" does not exist') ? `Error: Tabel 'materi' belum dibuat di database. Silakan buat tabel materi (Lihat file SQL).` : (error.message.includes('permission denied') ? `Akses Ditolak (RLS Error). Cek RLS tabel '${TABLE_NAME_MATERI}'.` : `Gagal memuat data: ${error.message}`);
                materiList.innerHTML = `<tr><td colspan="5" class="p-4 text-center text-red-500 font-bold">${errorMessage}</td></tr>`;
            }
        }
        materiForm && materiForm.addEventListener('submit', async (event) => { 
             event.preventDefault();
            const newMateri = {
                divisi: document.getElementById('divisi').value,
                judul_materi: document.getElementById('judul_materi').value.trim(),
                pembuat: document.getElementById('pembuat').value.trim() || null,
                tanggal_jadi: document.getElementById('tanggal_jadi').value || null,
                link_materi: document.getElementById('link_materi').value.trim(),
                ppt_link_materi: document.getElementById('ppt_link_materi').value.trim() || null,
            };

            if (!newMateri.divisi || !newMateri.judul_materi || !newMateri.link_materi) {
                showMessage(formMateriMessage, 'Divisi, Judul, dan Link Materi Utama wajib diisi!', 'text-red-500');
                return;
            }
            
            if (submitMateriButton) submitMateriButton.disabled = true;
            if (submitMateriButton) submitMateriButton.innerHTML = renderButtonContent('Menyimpan...', 'loader-circle');
            lucide.createIcons();

            try {
                const { error } = await supabaseClient.from(TABLE_NAME_MATERI).insert([newMateri]);
                if (error) throw error;
                materiForm.reset();
                showMessage(formMateriMessage, 'Materi berhasil ditambahkan!', 'text-green-500');
                fetchMateri(searchMateriInput ? searchMateriInput.value : '');
            } catch (error) {
                console.error('Error adding materi:', error.message);
                let errorMessage = error.message.includes('permission denied') ? `Gagal menambahkan materi: Akses Ditolak (RLS Error).` : `Gagal menambahkan materi: ${error.message}`;
                showMessage(formMateriMessage, errorMessage, 'text-red-500');
            } finally {
                if (submitMateriButton) submitMateriButton.disabled = false;
                if (submitMateriButton) submitMateriButton.innerHTML = renderButtonContent('Tambah Materi', 'folder-plus');
                lucide.createIcons();
            }
        });
        editMateriForm && editMateriForm.addEventListener('submit', async (e) => { 
            e.preventDefault();
            const materiId = document.getElementById('edit-id-materi').value;
            const updatedMateri = {
                divisi: document.getElementById('edit-divisi').value,
                judul_materi: document.getElementById('edit-judul_materi').value.trim(),
                pembuat: document.getElementById('edit-pembuat').value.trim() || null,
                tanggal_jadi: document.getElementById('edit-tanggal_jadi').value || null,
                link_materi: document.getElementById('edit-link_materi').value.trim(),
                ppt_link_materi: document.getElementById('edit-ppt_link_materi').value.trim() || null,
            };

            if (!updatedMateri.divisi || !updatedMateri.judul_materi || !updatedMateri.link_materi) {
                showMessage(editFormMateriMessage, 'Divisi, Judul, dan Link Materi wajib diisi!', 'text-red-500');
                return;
            }

            if (saveEditMateriButton) saveEditMateriButton.disabled = true;
            if (saveEditMateriButton) saveEditMateriButton.innerHTML = renderButtonContent('Menyimpan...', 'loader-circle');
            lucide.createIcons();

            try {
                const { error } = await supabaseClient.from(TABLE_NAME_MATERI).update(updatedMateri).eq('id', materiId);
                if (error) throw error;
                showMessage(editFormMateriMessage, 'Perubahan berhasil disimpan!', 'text-green-500');
                fetchMateri(searchMateriInput ? searchMateriInput.value : '');
                setTimeout(closeEditModal.bind(null, 'materi'), 1000);
            } catch (error) {
                console.error('Error updating materi:', error.message);
                let errorMessage = error.message.includes('permission denied') ? `Gagal menyimpan: Akses Ditolak (RLS Error).` : `Gagal menyimpan: ${error.message}`;
                showMessage(editFormMateriMessage, errorMessage, 'text-red-500');
            } finally {
                if (saveEditMateriButton) saveEditMateriButton.disabled = false;
                if (saveEditMateriButton) saveEditMateriButton.innerHTML = renderButtonContent('Simpan Perubahan Materi', 'check');
                lucide.createIcons();
            }
        });

        // --- LOGIKA ANGGOTA (BARU) ---

        function createAnggotaRow(anggota) {
            const anggotaJson = JSON.stringify(anggota).replace(/'/g, "\\'");
            const tglLahir = anggota.tanggal_lahir ? new Date(anggota.tanggal_lahir).toLocaleDateString('id-ID', { year: 'numeric', month: 'short', day: 'numeric' }) : '-';
            const orgLain = anggota.organisasi_lain || '-';
            const role = sessionStorage.getItem('userRole');

            // PERBAIKAN IKON CV
            const cvLink = anggota.link_cv ? 
                `<a href="${anggota.link_cv}" target="_blank" class="cv-link-cell cv-available" title="Lihat CV"><i data-lucide="file-text" class="w-4 h-4"></i></a>` :
                `<span class="cv-link-cell cv-missing" title="CV Tidak Ada"><i data-lucide="file-x" class="w-4 h-4"></i></span>`;

            const editButton = (role === 'admin') ? `
                <button onclick='openEditModal("anggota", ${anggotaJson})'
                    class="p-1 rounded-full border border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-200 hover:border-blue-400 transition duration-200 shadow-sm" 
                    title="Edit Anggota">
                    <i data-lucide="edit-3" class="w-4 h-4"></i>
                </button>
            ` : '';

            // Mengubah tampilan kolom Kontak & CV
            return `
                <tr class="hover:bg-yellow-50 transition duration-150">
                    <td class="px-3 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                        <span class="font-bold">${anggota.nama}</span>
                    </td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-500">${anggota.batch || '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">${anggota.jabatan || '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">${anggota.divisi || '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-500">${anggota.angkatan || '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-500">${tglLahir}</td>
                    <td class="px-3 py-4 whitespace-normal text-xs text-gray-700 truncate max-w-xs">${anggota.email ? `<a href="mailto:${anggota.email}" class="text-blue-600 hover:underline">${anggota.email}</a>` : '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-xs text-gray-700">${anggota.no_handphone || '-'}</td>
                    <td class="px-3 py-4 whitespace-normal text-xs text-gray-500">${orgLain}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm">${cvLink}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">
                        ${editButton}
                    </td>
                </tr>
            `;
        }

        async function fetchAnggota(searchTerm = '') {
            if (!anggotaList || !noAnggotaDataMessage) return;
            noAnggotaDataMessage.classList.add('hidden');
            const state = sortState.anggota;
            anggotaList.innerHTML = `<tr><td colspan="11" class="p-4 text-center text-gray-500 flex items-center justify-center"><i data-lucide="loader-circle" class="w-5 h-5 mr-2 animate-spin-fast"></i>Memuat data anggota...</td></tr>`;
            lucide.createIcons();
            updateTableHeaders('anggota');

            try {
                let query = supabaseClient.from(TABLE_NAME_ANGGOTA).select('*').order(state.col, { ascending: state.order === 'asc' });
                if (searchTerm) {
                    const searchPattern = `%${searchTerm.toLowerCase()}%`;
                    query = query.or(`nama.ilike.${searchPattern},jabatan.ilike.${searchPattern},divisi.ilike.${searchPattern}`);
                }
                const { data, error } = await query;
                if (error) { throw error; }

                anggotaList.innerHTML = '';
                if (data && data.length > 0) {
                    data.forEach(anggota => { anggotaList.insertAdjacentHTML('beforeend', createAnggotaRow(anggota)); });
                    lucide.createIcons();
                } else {
                    noAnggotaDataMessage.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Final fetching anggota error:', error.message);
                let errorMessage = error.message.includes('relation "anggota_hexacomm" does not exist') ? `Error: Tabel 'anggota_hexacomm' belum dibuat di database. Silakan buat tabel (Lihat file SQL).` : (error.message.includes('permission denied') ? `Akses Ditolak (RLS Error). Cek RLS tabel '${TABLE_NAME_ANGGOTA}'.` : `Gagal memuat data: ${error.message}`);
                anggotaList.innerHTML = `<tr><td colspan="11" class="p-4 text-center text-red-500 font-bold">${errorMessage}</td></tr>`;
            }
        }

        anggotaForm && anggotaForm.addEventListener('submit', async (event) => {
            event.preventDefault();
            const newAnggota = {
                nama: document.getElementById('anggota_nama').value.trim(),
                batch: document.getElementById('anggota_batch').value.trim() || null,
                jabatan: document.getElementById('anggota_jabatan').value,
                divisi: document.getElementById('anggota_divisi').value,
                angkatan: parseInt(document.getElementById('anggota_angkatan').value) || null,
                email: document.getElementById('anggota_email').value.trim() || null,
                no_handphone: document.getElementById('anggota_no_handphone').value.trim() || null,
                tanggal_lahir: document.getElementById('anggota_tanggal_lahir').value || null,
                organisasi_lain: document.getElementById('anggota_organisasi_lain').value.trim() || null,
                link_cv: document.getElementById('anggota_link_cv').value.trim() || null,
            };

            if (!newAnggota.nama || !newAnggota.jabatan || !newAnggota.divisi) {
                showMessage(formAnggotaMessage, 'Nama, Jabatan, dan Divisi wajib diisi!', 'text-red-500');
                return;
            }
            
            if (submitAnggotaButton) submitAnggotaButton.disabled = true;
            if (submitAnggotaButton) submitAnggotaButton.innerHTML = renderButtonContent('Menyimpan...', 'loader-circle');
            lucide.createIcons();

            try {
                const { error } = await supabaseClient.from(TABLE_NAME_ANGGOTA).insert([newAnggota]);
                if (error) throw error;
                anggotaForm.reset();
                showMessage(formAnggotaMessage, 'Anggota berhasil ditambahkan!', 'text-green-500');
                fetchAnggota(searchAnggotaInput ? searchAnggotaInput.value : '');
            } catch (error) {
                console.error('Error adding anggota:', error.message);
                let errorMessage = error.message.includes('permission denied') ? `Gagal menambahkan anggota: Akses Ditolak (RLS Error).` : `Gagal menambahkan anggota: ${error.message}`;
                showMessage(formAnggotaMessage, errorMessage, 'text-red-500');
            } finally {
                if (submitAnggotaButton) submitAnggotaButton.disabled = false;
                if (submitAnggotaButton) submitAnggotaButton.innerHTML = renderButtonContent('Tambah Anggota', 'user-plus');
                lucide.createIcons();
            }
        });

        editAnggotaForm && editAnggotaForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const anggotaId = document.getElementById('edit-id-anggota').value;
            const updatedAnggota = {
                nama: document.getElementById('edit-anggota_nama').value.trim(),
                batch: document.getElementById('edit-anggota_batch').value.trim() || null,
                jabatan: document.getElementById('edit-anggota_jabatan').value,
                divisi: document.getElementById('edit-anggota_divisi').value,
                angkatan: parseInt(document.getElementById('edit-anggota_angkatan').value) || null,
                email: document.getElementById('edit-anggota_email').value.trim() || null,
                no_handphone: document.getElementById('edit-anggota_no_handphone').value.trim() || null,
                tanggal_lahir: document.getElementById('edit-anggota_tanggal_lahir').value || null,
                organisasi_lain: document.getElementById('edit-anggota_organisasi_lain').value.trim() || null,
                link_cv: document.getElementById('edit-anggota_link_cv').value.trim() || null,
            };

            if (saveEditAnggotaButton) saveEditAnggotaButton.disabled = true;
            if (saveEditAnggotaButton) saveEditAnggotaButton.innerHTML = renderButtonContent('Menyimpan...', 'loader-circle');
            lucide.createIcons();

            try {
                const { error } = await supabaseClient.from(TABLE_NAME_ANGGOTA).update(updatedAnggota).eq('id', anggotaId);
                if (error) throw error;
                showMessage(editFormAnggotaMessage, 'Perubahan berhasil disimpan!', 'text-green-500');
                fetchAnggota(searchAnggotaInput ? searchAnggotaInput.value : '');
                setTimeout(closeEditModal.bind(null, 'anggota'), 1000);
            } catch (error) {
                console.error('Error updating anggota:', error.message);
                let errorMessage = error.message.includes('permission denied') ? `Gagal menyimpan: Akses Ditolak (RLS Error).` : `Gagal menyimpan: ${error.message}`;
                showMessage(editFormAnggotaMessage, errorMessage, 'text-red-500');
            } finally {
                if (saveEditAnggotaButton) saveEditAnggotaButton.disabled = false;
                if (saveEditAnggotaButton) saveEditAnggotaButton.innerHTML = renderButtonContent('Simpan Perubahan Anggota', 'check');
                lucide.createIcons();
            }
        });

        // --- LOGIKA ALUMNI (BARU) ---

        function createAlumniRow(alumni) {
            const alumniJson = JSON.stringify(alumni).replace(/'/g, "\\'");
            const role = sessionStorage.getItem('userRole');
            
            // PERBAIKAN IKON CV
            const cvLink = alumni.link_cv ? 
                `<a href="${alumni.link_cv}" target="_blank" class="cv-link-cell cv-available" title="Lihat CV"><i data-lucide="file-text" class="w-4 h-4"></i></a>` :
                `<span class="cv-link-cell cv-missing" title="CV Tidak Ada"><i data-lucide="file-x" class="w-4 h-4"></i></span>`;

            const editButton = (role === 'admin') ? `
                <button onclick='openEditModal("alumni", ${alumniJson})'
                    class="p-1 rounded-full border border-blue-200 bg-blue-50 text-blue-600 hover:bg-blue-200 hover:border-blue-400 transition duration-200 shadow-sm" 
                    title="Edit Alumni">
                    <i data-lucide="edit-3" class="w-4 h-4"></i>
                </button>
            ` : '';

            // Mengubah tampilan kolom Kontak & CV
            return `
                <tr class="hover:bg-yellow-50 transition duration-150">
                    <td class="px-3 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                        <span class="font-bold">${alumni.nama}</span>
                    </td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-500">${alumni.batch || '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">${alumni.angkatan || '-'}</td>
                    <td class="px-3 py-4 whitespace-normal text-sm text-gray-700">${alumni.bidang || '-'}</td>
                    <td class="px-3 py-4 whitespace-normal text-sm text-gray-500">${alumni.tempat_kerja || '-'}</td>
                    <td class="px-3 py-4 whitespace-normal text-xs text-gray-700 truncate max-w-xs">${alumni.email ? `<a href="mailto:${alumni.email}" class="text-blue-600 hover:underline">${alumni.email}</a>` : '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-xs text-gray-700">${alumni.no_handphone || '-'}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm">${cvLink}</td>
                    <td class="px-3 py-4 whitespace-nowrap text-sm text-gray-700">
                        ${editButton}
                    </td>
                </tr>
            `;
        }

        async function fetchAlumni(searchTerm = '') {
            if (!alumniList || !noAlumniDataMessage) return;
            noAlumniDataMessage.classList.add('hidden');
            const state = sortState.alumni;
            alumniList.innerHTML = `<tr><td colspan="9" class="p-4 text-center text-gray-500 flex items-center justify-center"><i data-lucide="loader-circle" class="w-5 h-5 mr-2 animate-spin-fast"></i>Memuat data alumni...</td></tr>`;
            lucide.createIcons();
            updateTableHeaders('alumni');

            try {
                let query = supabaseClient.from(TABLE_NAME_ALUMNI).select('*').order(state.col, { ascending: state.order === 'asc' });
                if (searchTerm) {
                    const searchPattern = `%${searchTerm.toLowerCase()}%`;
                    query = query.or(`nama.ilike.${searchPattern},tempat_kerja.ilike.${searchPattern},bidang.ilike.${searchPattern}`);
                }
                const { data, error } = await query;
                if (error) { throw error; }

                alumniList.innerHTML = '';
                if (data && data.length > 0) {
                    data.forEach(alumni => { alumniList.insertAdjacentHTML('beforeend', createAlumniRow(alumni)); });
                    lucide.createIcons();
                } else {
                    noAlumniDataMessage.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Final fetching alumni error:', error.message);
                let errorMessage = error.message.includes('relation "alumni" does not exist') ? `Error: Tabel 'alumni' belum dibuat di database. Silakan buat tabel (Lihat file SQL).` : (error.message.includes('permission denied') ? `Akses Ditolak (RLS Error). Cek RLS tabel '${TABLE_NAME_ALUMNI}'.` : `Gagal memuat data: ${error.message}`);
                alumniList.innerHTML = `<tr><td colspan="9" class="p-4 text-center text-red-500 font-bold">${errorMessage}</td></tr>`;
            }
        }

        alumniForm && alumniForm.addEventListener('submit', async (event) => {
            event.preventDefault();
            const newAlumni = {
                nama: document.getElementById('alumni_nama').value.trim(),
                batch: document.getElementById('alumni_batch').value.trim() || null,
                angkatan: parseInt(document.getElementById('alumni_angkatan').value) || null,
                bidang: document.getElementById('alumni_bidang').value.trim() || null,
                tempat_kerja: document.getElementById('alumni_tempat_kerja').value.trim() || null,
                no_handphone: document.getElementById('alumni_no_handphone').value.trim() || null,
                email: document.getElementById('alumni_email').value.trim() || null,
                link_cv: document.getElementById('alumni_link_cv').value.trim() || null,
            };

            if (!newAlumni.nama) {
                showMessage(formAlumniMessage, 'Nama wajib diisi!', 'text-red-500');
                return;
            }
            
            if (submitAlumniButton) submitAlumniButton.disabled = true;
            if (submitAlumniButton) submitAlumniButton.innerHTML = renderButtonContent('Menyimpan...', 'loader-circle');
            lucide.createIcons();

            try {
                const { error } = await supabaseClient.from(TABLE_NAME_ALUMNI).insert([newAlumni]);
                if (error) throw error;
                alumniForm.reset();
                showMessage(formAlumniMessage, 'Data alumni berhasil ditambahkan!', 'text-green-500');
                fetchAlumni(searchAlumniInput ? searchAlumniInput.value : '');
            } catch (error) {
                console.error('Error adding alumni:', error.message);
                let errorMessage = error.message.includes('permission denied') ? `Gagal menambahkan alumni: Akses Ditolak (RLS Error).` : `Gagal menambahkan alumni: ${error.message}`;
                showMessage(formAlumniMessage, errorMessage, 'text-red-500');
            } finally {
                if (submitAlumniButton) submitAlumniButton.disabled = false;
                if (submitAlumniButton) submitAlumniButton.innerHTML = renderButtonContent('Tambah Alumni', 'briefcase-business');
                lucide.createIcons();
            }
        });

        editAlumniForm && editAlumniForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const alumniId = document.getElementById('edit-id-alumni').value;
            const updatedAlumni = {
                nama: document.getElementById('edit-alumni_nama').value.trim(),
                batch: document.getElementById('edit-alumni_batch').value.trim() || null,
                angkatan: parseInt(document.getElementById('edit-alumni_angkatan').value) || null,
                bidang: document.getElementById('edit-alumni_bidang').value.trim() || null,
                tempat_kerja: document.getElementById('edit-alumni_tempat_kerja').value.trim() || null,
                no_handphone: document.getElementById('edit-alumni_no_handphone').value.trim() || null,
                email: document.getElementById('edit-alumni_email').value.trim() || null,
                link_cv: document.getElementById('edit-alumni_link_cv').value.trim() || null,
            };

            if (saveEditAlumniButton) saveEditAlumniButton.disabled = true;
            if (saveEditAlumniButton) saveEditAlumniButton.innerHTML = renderButtonContent('Menyimpan...', 'loader-circle');
            lucide.createIcons();

            try {
                const { error } = await supabaseClient.from(TABLE_NAME_ALUMNI).update(updatedAlumni).eq('id', alumniId);
                if (error) throw error;
                showMessage(editFormAlumniMessage, 'Perubahan berhasil disimpan!', 'text-green-500');
                fetchAlumni(searchAlumniInput ? searchAlumniInput.value : '');
                setTimeout(closeEditModal.bind(null, 'alumni'), 1000);
            } catch (error) {
                console.error('Error updating alumni:', error.message);
                let errorMessage = error.message.includes('permission denied') ? `Gagal menyimpan: Akses Ditolak (RLS Error).` : `Gagal menyimpan: ${error.message}`;
                showMessage(editFormAlumniMessage, errorMessage, 'text-red-500');
            } finally {
                if (saveEditAlumniButton) saveEditAlumniButton.disabled = false;
                if (saveEditAlumniButton) saveEditAlumniButton.innerHTML = renderButtonContent('Simpan Perubahan Alumni', 'check');
                lucide.createIcons();
            }
        });


        // --- LOGIKA MODAL UTAMA ---

        window.openEditModal = (type, data) => {
            if (type === 'paper') {
                document.getElementById('edit-id-paper').value = data.id;
                document.getElementById('edit-title-display-paper').textContent = data.title;
                document.getElementById('edit-authors-paper').value = data.authors || '';
                document.getElementById('edit-status-paper').value = data.status;
                document.getElementById('edit-category-paper').value = data.category || '';
                document.getElementById('edit-deadline-paper').value = data.deadline ? data.deadline.split('T')[0] : '';
                document.getElementById('edit-reference_link-paper').value = data.reference_link || '';
                document.getElementById('edit-overleaf_link-paper').value = data.overleaf_link || '';
                document.getElementById('edit-ppt_link-paper').value = data.ppt_link || '';

                if (editFormPaperMessage) editFormPaperMessage.classList.add('hidden');
                if (editModal) editModal.classList.remove('hidden');
            } else if (type === 'materi') {
                document.getElementById('edit-id-materi').value = data.id;
                document.getElementById('edit-judul_materi').value = data.judul_materi;
                document.getElementById('edit-divisi').value = data.divisi;
                document.getElementById('edit-pembuat').value = data.pembuat || '';
                document.getElementById('edit-tanggal_jadi').value = data.tanggal_jadi ? data.tanggal_jadi.split('T')[0] : '';
                document.getElementById('edit-link_materi').value = data.link_materi || '';
                document.getElementById('edit-ppt_link_materi').value = data.ppt_link_materi || '';
                
                if (editFormMateriMessage) editFormMateriMessage.classList.add('hidden');
                if (editMateriModal) editMateriModal.classList.remove('hidden');
            } else if (type === 'anggota') { // BARU
                document.getElementById('edit-id-anggota').value = data.id;
                document.getElementById('edit-anggota_nama').value = data.nama;
                document.getElementById('edit-anggota_batch').value = data.batch || '';
                document.getElementById('edit-anggota_angkatan').value = data.angkatan || '';
                document.getElementById('edit-anggota_email').value = data.email || '';
                document.getElementById('edit-anggota_no_handphone').value = data.no_handphone || '';
                document.getElementById('edit-anggota_tanggal_lahir').value = data.tanggal_lahir ? data.tanggal_lahir.split('T')[0] : '';
                document.getElementById('edit-anggota_organisasi_lain').value = data.organisasi_lain || '';
                document.getElementById('edit-anggota_link_cv').value = data.link_cv || '';

                populateSelect(document.getElementById('edit-anggota_jabatan'), JABATAN_OPTIONS, data.jabatan);
                populateSelect(document.getElementById('edit-anggota_divisi'), DIVISI_OPTIONS, data.divisi);

                if (editFormAnggotaMessage) editFormAnggotaMessage.classList.add('hidden');
                if (editAnggotaModal) editAnggotaModal.classList.remove('hidden');
            } else if (type === 'alumni') { // BARU
                document.getElementById('edit-id-alumni').value = data.id;
                document.getElementById('edit-alumni_nama').value = data.nama;
                document.getElementById('edit-alumni_batch').value = data.batch || '';
                document.getElementById('edit-alumni_angkatan').value = data.angkatan || '';
                document.getElementById('edit-alumni_bidang').value = data.bidang || '';
                document.getElementById('edit-alumni_tempat_kerja').value = data.tempat_kerja || '';
                document.getElementById('edit-alumni_no_handphone').value = data.no_handphone || '';
                document.getElementById('edit-alumni_email').value = data.email || '';
                document.getElementById('edit-alumni_link_cv').value = data.link_cv || '';
                
                if (editFormAlumniMessage) editFormAlumniMessage.classList.add('hidden');
                if (editAlumniModal) editAlumniModal.classList.remove('hidden');
            }
            lucide.createIcons();
        }

        window.closeEditModal = (type) => {
            if (type === 'paper' && editModal) editModal.classList.add('hidden');
            if (type === 'materi' && editMateriModal) editMateriModal.classList.add('hidden');
            if (type === 'anggota' && editAnggotaModal) editAnggotaModal.classList.add('hidden');
            if (type === 'alumni' && editAlumniModal) editAlumniModal.classList.add('hidden');
        }


        // --- UTILITY PESAN & EVENT LISTENER PENCARIAN ---

        let searchTimeout;
        const setupSearchListeners = () => {
            searchPaperInput && searchPaperInput.addEventListener('input', () => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => { fetchPapers(searchPaperInput.value); }, 300);
            });

            searchMateriInput && searchMateriInput.addEventListener('input', () => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => { fetchMateri(searchMateriInput.value); }, 300);
            });

            searchAnggotaInput && searchAnggotaInput.addEventListener('input', () => { // BARU
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => { fetchAnggota(searchAnggotaInput.value); }, 300);
            });

            searchAlumniInput && searchAlumniInput.addEventListener('input', () => { // BARU
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => { fetchAlumni(searchAlumniInput.value); }, 300);
            });
        };
        
        // --- INISIALISASI ---

        document.addEventListener('DOMContentLoaded', () => {
            // Setup Forms
            if (submitPaperButton) submitPaperButton.innerHTML = renderButtonContent('Tambah Paper', 'file-plus');
            if (submitMateriButton) submitMateriButton.innerHTML = renderButtonContent('Tambah Materi', 'folder-plus');
            if (submitAnggotaButton) submitAnggotaButton.innerHTML = renderButtonContent('Tambah Anggota', 'user-plus'); // BARU
            if (submitAlumniButton) submitAlumniButton.innerHTML = renderButtonContent('Tambah Alumni', 'briefcase-business'); // BARU

            // Populate Dropdowns
            populateSelect(document.getElementById('anggota_jabatan'), JABATAN_OPTIONS);
            populateSelect(document.getElementById('anggota_divisi'), DIVISI_OPTIONS);

            setupSearchListeners();
            checkSession();
            lucide.createIcons();
        });

    </script>
</body>
</html>
